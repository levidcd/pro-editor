"use strict";(self.webpackChunk_ant_design_pro_editor=self.webpackChunk_ant_design_pro_editor||[]).push([[629],{629:function(b,x,t){t.r(x),t.d(x,{default:function(){return Q}});var c=t(50959),y=t(26068),l=t.n(y),C=t(48305),F=t.n(C),p=t(74629),M=t(50487),$=t(3341),w=t.n($),B=t(88475),E=t(89108),L=t(43820),d=t(24920),R=t(64392),T=t(74056),W=t(41428),f=t(79606),P=(0,d.R)(document,"mousemove").pipe((0,R.x)(),(0,f.U)(function(n){return{x:n.clientX,y:n.clientY}}),(0,T.O)({x:-100,y:-100})),X=(0,W.T)((0,d.R)(document,"visibilitychange").pipe((0,f.U)(function(){return document.visibilityState})),(0,d.R)(window,"focus").pipe((0,f.U)(function(){return document.visibilityState})),(0,d.R)(window,"blur").pipe((0,f.U)(function(){return"hidden"}))),Z=function(r){var a=r.onMouseMove,e=r.onBlur;(0,c.useEffect)(function(){var u=P.subscribe(a),s=X.subscribe(e);return function(){u.unsubscribe(),s.unsubscribe()}},[])},G=function(r,a){var e=(0,L.F)(function(v){return{provider:r,awareness:r.awareness,currentUser:l()({id:(0,B.x0)()},a),awarenessStates:[],setFollowUser:function(S){v({followUser:S})}}},w()),u=e.getState(),s=u.awareness;return Z({onMouseMove:function(o){s.setLocalStateField("cursor",o)},onBlur:function(o){s.setLocalStateField("active",o==="visible")}}),(0,c.useEffect)(function(){s.on("change",function(){var v=Array.from(s.getStates().values());e.setState(function(o){return l()(l()({},o),{},{awarenessStates:v})})}),s.setLocalStateField("user",e.getState().currentUser),s.setLocalStateField("active",!0)},[]),e},A=(0,E.k)(),U=A.useStore,O=A.Provider,k=A.useStoreApi,Y=t(36941),i=t(11527),z=function(r){var a=r.id,e=r.name,u=r.color,s=r.active,v=U(function(m){return[m.followUser,m.currentUser,m.setFollowUser]},M.X),o=F()(v,3),S=o[0],V=o[1],g=o[2],h=V===a,j=S&&S===a;return(0,i.jsx)(Y.Z,{name:e,current:h,following:j,color:u,active:s,onClick:function(){h||g(j?void 0:a)}})},D=(0,c.memo)(function(){var n=U(function(r){return r.awarenessStates});return(0,i.jsx)(p.C.Group,{children:n==null?void 0:n.filter(Boolean).map(function(r,a){var e=r.user,u=r.active;return(0,i.jsx)(z,l()({active:u},e),"".concat(e==null?void 0:e.id,"-").concat(a))})})}),H=D,I=t(60721),J=(0,c.memo)(function(){var n=U(function(r){var a;return(a=r.awarenessStates)===null||a===void 0?void 0:a.filter(function(e){return e.active&&e.user.id!==r.currentUser.id})},w());return(0,i.jsx)(i.Fragment,{children:n==null?void 0:n.map(function(r){var a=r.cursor,e=r.user;return(0,i.jsx)(I.Z,{position:a,color:e.color,name:e.name},e.id)})})}),K=J,N=(0,c.memo)(function(n){var r=n.provider,a=n.avatars,e=a===void 0?!0:a,u=n.cursors,s=u===void 0?!0:u,v=n.user;return(0,i.jsxs)(O,{createStore:function(){return G(r,v)},children:[s&&(0,i.jsx)(K,{}),e&&(0,i.jsx)(H,{})]})}),Q=N}}]);
